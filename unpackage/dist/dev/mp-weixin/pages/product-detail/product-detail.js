(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product-detail/product-detail"],{86:function(t,e,a){"use strict";(function(t){a(5);r(a(4));var e=r(a(87));function r(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=a,t(e.default)}).call(this,a(1)["createPage"])},87:function(t,e,a){"use strict";a.r(e);var r=a(88),n=a(90);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a(92);var o,c=a(11),s=Object(c["default"])(n["default"],r["render"],r["staticRenderFns"],!1,null,"685304e6",null,!1,r["components"],o);s.options.__file="pages/product-detail/product-detail.vue",e["default"]=s.exports},88:function(t,e,a){"use strict";a.r(e);var r=a(89);a.d(e,"render",(function(){return r["render"]})),a.d(e,"staticRenderFns",(function(){return r["staticRenderFns"]})),a.d(e,"recyclableRender",(function(){return r["recyclableRender"]})),a.d(e,"components",(function(){return r["components"]}))},89:function(t,e,a){"use strict";var r;a.r(e),a.d(e,"render",(function(){return n})),a.d(e,"staticRenderFns",(function(){return o})),a.d(e,"recyclableRender",(function(){return i})),a.d(e,"components",(function(){return r}));var n=function(){var t=this,e=t.$createElement;t._self._c},i=!1,o=[];n._withStripped=!0},90:function(t,e,a){"use strict";a.r(e);var r=a(91),n=a.n(r);for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},91:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(a(37));function n(t){return t&&t.__esModule?t:{default:t}}function i(t){return u(t)||s(t)||c(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"===typeof t)return d(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(t,e):void 0}}function s(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function u(t){if(Array.isArray(t))return d(t)}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function p(t,e,a,r,n,i,o){try{var c=t[i](o),s=c.value}catch(u){return void a(u)}c.done?e(s):Promise.resolve(s).then(r,n)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var i=t.apply(e,a);function o(t){p(i,r,n,o,c,"next",t)}function c(t){p(i,r,n,o,c,"throw",t)}o(void 0)}))}}var h=function(){a.e("components/product-detail/BuyPageChoose").then(function(){return resolve(a(179))}.bind(null,a)).catch(a.oe)},m=function(){a.e("components/location/NearlyShopList").then(function(){return resolve(a(137))}.bind(null,a)).catch(a.oe)},f={data:function(){return{type:String,ename:String,date:Number,name:"",productReviewArr:[],nearlyShop:"查找中...",nearlyAddress:"",shopLat:Number,shopLng:Number,distance:Number,introduce:"",paramsColor:"",paramsStorage:{size:"",price:0},paramsConnectWay:{size:"",price:0},paramsMacStorage:{size:"",price:0},price:Number,isShowBuyPage:!1,buyPageImg:"",colorArr:[],activeIndex_color:0,storageArr:[],activeIndex_storage:0,storage_price:Number,macStorageArr:[],activeIndex_macStorage:0,macStorage_price:Number,connectWayArr:[],activeIndex_connectWay:0,connectWay_price:Number,nearlyShopArr:[],nearlyShopImgArr:[],animationData1:{},animationData2:{},subkey:"M7ABZ-22FH4-7URUL-XDEVT-MSXO2-3FBLZ",qqmapsdk:{},currentLatitude:Number,currentLongitude:Number}},onLoad:function(t){var e=this,a=JSON.parse(decodeURIComponent(t.item));this.type=a.type,this.ename=a.ename,this.date=a.date,this.name=a.name,this.price=parseInt(a.price),this.getProductDetail(),this.setAnimation(),l(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCurrentLocaiton();case 2:return t.next=4,e.getAppleShopInCurrentCity(e.currentLatitude,e.currentLongitude);case 4:e.nearlyShop=e.nearlyShopArr[0].title,e.nearlyAddress=e.nearlyShopArr[0].address,e.distance=e.nearlyShopArr[0].distance,e.shopLat=e.nearlyShopArr[0].latitude,e.shopLng=e.nearlyShopArr[0].longitude;case 9:case"end":return t.stop()}}),t)})))(),this.$http.request({url:"/location-list/data"}).then((function(t){e.nearlyShopImgArr=t.data[2].imgUrl,e.currentLocationImg=t.data[0].imgUrl,e.locationImg=t.data[1].imgUrl}))},computed:{add_price:function(){var t=parseInt(this.price+this.paramsStorage.price+this.paramsMacStorage.price+this.paramsConnectWay.price);return t}},methods:{getShopMessage:function(t,e,a,r,n){this.nearlyShop=t,this.nearlyAddress=e,this.distance=a,this.shopLat=r,this.shopLng=n},getProductDetail:function(){var t=this;this.$http.request({url:"/product-detail/"+this.type+"/"+this.ename+"/"+this.date,data:{ename:this.ename,date:this.date}}).then((function(e){var a;t.paramsColor=e.data.productReview.color[0].type,e.data.productReview.storage.length&&(t.paramsStorage.size=e.data.productReview.storage[0].size),e.data.productReview.connectWay.length&&(t.paramsConnectWay.size=e.data.productReview.connectWay[0].size),e.data.productReview.macstorage.length&&(t.paramsMacStorage.size=e.data.productReview.macstorage[0].chip),t.productReviewArr=e.data.productReview.imgUrl,(a=t.productReviewArr).unshift.apply(a,i(e.data.productReview.color[0].imgUrl)),t.introduce=e.data.productReview.introduce,t.buyPageImg=e.data.productReview.color[0].imgUrl[0],t.colorArr=e.data.productReview.color,t.storageArr=e.data.productReview.storage,t.macStorageArr=e.data.productReview.macstorage,t.connectWayArr=e.data.productReview.connectWay}))},updateProductReview:function(t){for(var e=this.colorArr[t].imgUrl,a=0;a<e.length;a++)this.productReviewArr[a]=e[a];this.buyPageImg=e[0]},backTo:function(){t.navigateBack()},toBuyPage:function(){this.slideUpShow()},closeMask:function(){this.slideUpHide()},chooseColor:function(t){this.activeIndex_color=t,this.updateProductReview(t),this.paramsColor=this.colorArr[t].type},chooseStorage:function(t){this.activeIndex_storage=t,this.paramsStorage.size=this.storageArr[t].size,this.paramsStorage.price=this.storageArr[t].price},chooseMacStorage:function(t){this.activeIndex_macStorage=t,this.paramsMacStorage.size=this.macStorageArr[t].size,this.paramsMacStorage.price=this.macStorageArr[t].price},chooseConnectWay:function(t){this.activeIndex_connectWay=t,this.paramsConnectWay.size=this.connectWayArr[t].size,this.paramsConnectWay.price=this.connectWayArr[t].price},toPay:function(){var e=this;t.showModal({content:"即将打开“订单中心 Aqqle 授权专营店”小程序？",cancelText:"取消",cancelColor:"#7f7f7f",confirmText:"允许",confirmColor:"#007aff",success:function(a){a.confirm&&t.navigateToMiniProgram({appId:"wxa78cf6bb9295673e",extraData:{goodsImg:e.buyPageImg,name:e.name,paramsColor:e.paramsColor,paramsStorage:e.paramsStorage.size,paramsConnectWay:e.paramsConnectWay.size,paramsMacStorage:e.paramsMacStorage.size,price:e.add_price,shop:e.nearlyShop,address:e.nearlyAddress,distance:e.distance}})}})},setAnimation:function(){var e=t.createAnimation({duration:200,timingFunction:"ease"});this.animation1=e;var a=t.createAnimation({duration:200,timingFunction:"ease"});this.animation2=a},slideUpShow:function(){var t=this;this.isShowBuyPage=!0,this.animation1.bottom("-800rpx").step(),this.animation2.opacity(0).step(),this.animationData1=this.animation1.export(),this.animationData2=this.animation2.export(),this.timer=setTimeout((function(){t.animation1.bottom(0).step(),t.animation2.opacity(1).step(),t.animationData1=t.animation1.export(),t.animationData2=t.animation2.export()}),10)},slideUpHide:function(){var t=this;this.animation1.bottom("-690rpx").step(),this.animation2.opacity(0).step(),this.animationData1=this.animation1.export(),this.animationData2=this.animation2.export(),setTimeout((function(){t.isShowBuyPage=!1}),200)},getCurrentLocaiton:function(){var e=this;return new Promise((function(a,r){e.qqmapsdk=new e.QQMapWX({key:e.subkey}),t.getLocation({type:"gcj02",success:function(t){e.currentLatitude=t.latitude,e.currentLongitude=t.longitude,a()}})}))},getAppleShopInCurrentCity:function(t,e){var a=this;return new Promise((function(n,i){a.nearlyShopArr=[],a.qqmapsdk.search({keyword:"Apple授权专营店-店",location:{latitude:t,longitude:e},page_size:20,success:function(){var t=l(r.default.mark((function t(e){var i,o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e.count){t.next=6;break}a.loadingTip="暂无门店",a.nearlyShopArr=[{id:0}],a.isShowLoading=!0,t.next=19;break;case 6:i=0;case 7:if(!(i<e.data.length)){t.next=18;break}if(-1!=e.data[i].title.indexOf("-")){t.next=10;break}return t.abrupt("continue",15);case 10:return t.next=12,a.getDistance(e.data[i].location.lat,e.data[i].location.lng);case 12:return o=t.sent,t.next=15,a.addNearlyShopArr(e,i,o);case 15:i++,t.next=7;break;case 18:a.isShowLoading=!1;case 19:n();case 20:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})}))},getDistance:function(t,e,a){var r=this;return new Promise((function(a,n){r.qqmapsdk.calculateDistance({mode:"straight",from:{latitude:r.currentLatitude,longitude:r.currentLongitude},to:[{latitude:t,longitude:e}],success:function(t){a((t.result.elements[0].distance/1e3).toFixed(2))}})}))},addNearlyShopArr:function(t,e,a){var r={id:e,title:t.data[e].title,latitude:t.data[e].location.lat,longitude:t.data[e].location.lng,address:t.data[e].address,distance:a,iconPath:this.locationImg,width:"40rpx",height:"40rpx",callout:{content:t.data[e].title,color:"white",fontSize:"26rpx",borderRadius:"12rpx",bgColor:"black",padding:"10rpx 10rpx"}};this.nearlyShopArr.push(r)}},components:{BuyPageChoose:h,NearlyShopList:m}};e.default=f}).call(this,a(1)["default"])},92:function(t,e,a){"use strict";a.r(e);var r=a(93),n=a.n(r);for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},93:function(t,e,a){}},[[86,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/product-detail/product-detail.js.map